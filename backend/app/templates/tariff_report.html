<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tariff Calculation Report</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }

        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            color: #333;
            line-height: 1.6;
            font-size: 11pt;
        }

        .header {
            border-bottom: 3px solid #2563eb;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #1e40af;
            font-size: 24pt;
            margin: 0;
            font-weight: 700;
        }

        .header .subtitle {
            color: #64748b;
            font-size: 10pt;
            margin-top: 5px;
        }

        .metadata {
            background-color: #f1f5f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 25px;
        }

        .metadata-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .metadata-label {
            font-weight: 600;
            color: #475569;
        }

        .metadata-value {
            color: #1e293b;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            color: #1e40af;
            font-size: 16pt;
            font-weight: 700;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 8px;
            margin-bottom: 15px;
        }

        .hs-code-box {
            background-color: #eff6ff;
            border-left: 4px solid #2563eb;
            padding: 15px;
            margin-bottom: 20px;
        }

        .hs-code {
            font-size: 18pt;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 5px;
        }

        .hs-description {
            color: #475569;
            font-size: 10pt;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th {
            background-color: #2563eb;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 10pt;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid #e2e8f0;
        }

        tr:nth-child(even) {
            background-color: #f8fafc;
        }

        .rate-label {
            font-weight: 600;
            color: #475569;
        }

        .rate-value {
            text-align: right;
            font-weight: 600;
            color: #1e293b;
        }

        .cost-summary {
            background-color: #f8fafc;
            border: 2px solid #e2e8f0;
            padding: 20px;
            margin-top: 20px;
            border-radius: 5px;
        }

        .cost-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .cost-row:last-child {
            border-bottom: none;
        }

        .cost-label {
            font-weight: 600;
            color: #475569;
        }

        .cost-value {
            font-weight: 600;
            color: #1e293b;
        }

        .total-row {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 3px solid #2563eb;
            font-size: 14pt;
        }

        .total-row .cost-label {
            color: #1e40af;
            font-size: 14pt;
        }

        .total-row .cost-value {
            color: #1e40af;
            font-size: 14pt;
        }

        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            text-align: center;
            color: #64748b;
            font-size: 9pt;
        }

        .currency-badge {
            background-color: #dbeafe;
            color: #1e40af;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 9pt;
            font-weight: 600;
        }

        .warning-box {
            background-color: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            margin-top: 20px;
            font-size: 9pt;
            color: #92400e;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>Tariff Calculation Report</h1>
        <div class="subtitle">Generated by TariffNavigator</div>
    </div>

    <!-- Metadata -->
    <div class="metadata">
        <div class="metadata-row">
            <span class="metadata-label">Report Date:</span>
            <span class="metadata-value">{{ generated_date }} at {{ generated_time }}</span>
        </div>
        <div class="metadata-row">
            <span class="metadata-label">Country:</span>
            <span class="metadata-value">{{ country }}</span>
        </div>
        {% if origin_country and destination_country %}
        <div class="metadata-row">
            <span class="metadata-label">Trade Lane:</span>
            <span class="metadata-value">{{ origin_country }} â†’ {{ destination_country }}</span>
        </div>
        {% endif %}
    </div>

    <!-- HS Code Section -->
    <div class="section">
        <div class="section-title">Product Classification</div>
        <div class="hs-code-box">
            <div class="hs-code">HS Code: {{ hs_code }}</div>
            <div class="hs-description">{{ description }}</div>
        </div>
    </div>

    <!-- Tariff Rates Section -->
    <div class="section">
        <div class="section-title">Applicable Tariff Rates</div>
        <table>
            <thead>
                <tr>
                    <th>Rate Type</th>
                    <th style="text-align: right;">Rate (%)</th>
                </tr>
            </thead>
            <tbody>
                {% if rates %}
                    {% if rates.mfn is defined %}
                    <tr>
                        <td class="rate-label">MFN (Most Favored Nation)</td>
                        <td class="rate-value">{{ "%.2f"|format(rates.mfn) }}%</td>
                    </tr>
                    {% endif %}
                    {% if rates.vat is defined and rates.vat > 0 %}
                    <tr>
                        <td class="rate-label">VAT (Value Added Tax)</td>
                        <td class="rate-value">{{ "%.2f"|format(rates.vat) }}%</td>
                    </tr>
                    {% endif %}
                    {% if rates.consumption is defined and rates.consumption > 0 %}
                    <tr>
                        <td class="rate-label">Consumption Tax</td>
                        <td class="rate-value">{{ "%.2f"|format(rates.consumption) }}%</td>
                    </tr>
                    {% endif %}
                {% endif %}
            </tbody>
        </table>
    </div>

    <!-- Cost Calculation Section -->
    <div class="section">
        <div class="section-title">Cost Calculation</div>

        {% if calculation %}
        <div class="cost-summary">
            <div class="cost-row">
                <span class="cost-label">CIF Value:</span>
                <span class="cost-value">
                    {{ "%.2f"|format(calculation.cif_value) }}
                    <span class="currency-badge">{{ calculation.currency }}</span>
                </span>
            </div>

            {% if calculation.customs_duty is defined %}
            <div class="cost-row">
                <span class="cost-label">Customs Duty:</span>
                <span class="cost-value">{{ "%.2f"|format(calculation.customs_duty) }} {{ calculation.currency }}</span>
            </div>
            {% endif %}

            {% if calculation.vat is defined and calculation.vat > 0 %}
            <div class="cost-row">
                <span class="cost-label">VAT:</span>
                <span class="cost-value">{{ "%.2f"|format(calculation.vat) }} {{ calculation.currency }}</span>
            </div>
            {% endif %}

            {% if calculation.consumption_tax is defined and calculation.consumption_tax > 0 %}
            <div class="cost-row">
                <span class="cost-label">Consumption Tax:</span>
                <span class="cost-value">{{ "%.2f"|format(calculation.consumption_tax) }} {{ calculation.currency }}</span>
            </div>
            {% endif %}

            <div class="cost-row total-row">
                <span class="cost-label">Total Landed Cost:</span>
                <span class="cost-value">{{ "%.2f"|format(calculation.total_cost) }} {{ calculation.currency }}</span>
            </div>
        </div>
        {% endif %}

        <!-- Currency Conversion (if applicable) -->
        {% if converted_calculation %}
        <div class="section-title" style="margin-top: 25px; font-size: 12pt;">Converted Calculation</div>
        <div class="metadata" style="margin-top: 10px;">
            <div class="metadata-row">
                <span class="metadata-label">Exchange Rate:</span>
                <span class="metadata-value">1 {{ original_currency }} = {{ "%.4f"|format(exchange_rate) }} {{ converted_calculation.currency }}</span>
            </div>
        </div>

        <div class="cost-summary">
            <div class="cost-row">
                <span class="cost-label">CIF Value:</span>
                <span class="cost-value">
                    {{ "%.2f"|format(converted_calculation.cif_value) }}
                    <span class="currency-badge">{{ converted_calculation.currency }}</span>
                </span>
            </div>

            {% if converted_calculation.customs_duty is defined %}
            <div class="cost-row">
                <span class="cost-label">Customs Duty:</span>
                <span class="cost-value">{{ "%.2f"|format(converted_calculation.customs_duty) }} {{ converted_calculation.currency }}</span>
            </div>
            {% endif %}

            {% if converted_calculation.vat is defined and converted_calculation.vat > 0 %}
            <div class="cost-row">
                <span class="cost-label">VAT:</span>
                <span class="cost-value">{{ "%.2f"|format(converted_calculation.vat) }} {{ converted_calculation.currency }}</span>
            </div>
            {% endif %}

            {% if converted_calculation.consumption_tax is defined and converted_calculation.consumption_tax > 0 %}
            <div class="cost-row">
                <span class="cost-label">Consumption Tax:</span>
                <span class="cost-value">{{ "%.2f"|format(converted_calculation.consumption_tax) }} {{ converted_calculation.currency }}</span>
            </div>
            {% endif %}

            <div class="cost-row total-row">
                <span class="cost-label">Total Landed Cost:</span>
                <span class="cost-value">{{ "%.2f"|format(converted_calculation.total_cost) }} {{ converted_calculation.currency }}</span>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Disclaimer -->
    <div class="warning-box">
        <strong>Disclaimer:</strong> This calculation is for reference purposes only. Actual duties and taxes may vary based on specific circumstances, product classification, trade agreements, and regulatory changes. Please consult with a licensed customs broker or trade compliance professional for official guidance.
    </div>

    <!-- Footer -->
    <div class="footer">
        <p><strong>TariffNavigator</strong> - Professional Tariff Calculation Platform</p>
        <p>This report was automatically generated and is valid as of {{ generated_date }}</p>
    </div>
</body>
</html>
